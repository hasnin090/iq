# 📋 متطلبات نظام المحاسبة العربي الشامل - شركة طريق العامرة

## 🌟 نظرة عامة على النظام

نظام محاسبة ومالي متكامل باللغة العربية يهدف إلى:
- إدارة المشاريع والميزانيات
- تتبع المعاملات المالية والمصروفات
- إدارة المستندات والوثائق
- متابعة المستحقات والمدفوعات
- إدارة الموظفين والرواتب
- عرض التقارير وإحصائيات الأداء
- دعم أدوار متعددة (مدير، مستخدم، محاسب، مشاهد)

## 📊 جداول وأعمدة قاعدة البيانات

### 1. جدول الملفات الشخصية للمستخدمين (profiles)
- **id** (UUID): المفتاح الرئيسي، مرتبط بجدول المستخدمين في Supabase Auth
- **full_name** (TEXT): الاسم الكامل للمستخدم
- **role** (TEXT): دور المستخدم (admin, manager, user, viewer, accountant)
- **permissions** (TEXT[]): مصفوفة الصلاحيات
- **phone** (VARCHAR): رقم الهاتف
- **avatar_url** (TEXT): رابط الصورة الشخصية
- **last_login** (TIMESTAMPTZ): آخر تسجيل دخول
- **created_at, updated_at** (TIMESTAMPTZ): تواريخ الإنشاء والتحديث

### 2. جدول المشاريع (projects)
- **id** (UUID): المفتاح الرئيسي
- **name** (TEXT): اسم المشروع
- **description** (TEXT): وصف المشروع
- **status** (TEXT): حالة المشروع (active, completed, cancelled, on_hold)
- **budget** (DECIMAL): الميزانية المخصصة
- **spent** (DECIMAL): المبلغ المصروف
- **remaining** (DECIMAL): المبلغ المتبقي
- **client_name** (TEXT): اسم العميل
- **client_contact** (TEXT): معلومات التواصل مع العميل
- **start_date, end_date** (DATE): تاريخ البدء والانتهاء
- **active** (BOOLEAN): هل المشروع نشط
- **owner_id** (UUID): معرّف مالك المشروع
- **location** (TEXT): موقع المشروع
- **created_at, updated_at** (TIMESTAMPTZ): تواريخ الإنشاء والتحديث

### 3. جدول أدوار المستخدمين (user_roles)
- **id** (UUID): المفتاح الرئيسي
- **user_id** (UUID): معرّف المستخدم
- **project_id** (UUID): معرّف المشروع
- **role** (TEXT): الدور (owner, member, viewer)
- **created_at** (TIMESTAMPTZ): تاريخ الإنشاء

### 4. جدول أنواع المصروفات (expense_types)
- **id** (UUID): المفتاح الرئيسي
- **name** (TEXT): اسم نوع المصروف
- **description** (TEXT): وصف نوع المصروف
- **active** (BOOLEAN): هل النوع نشط
- **category** (TEXT): فئة المصروف (مواد، أجور، معدات، إدارية)
- **budget_limit** (DECIMAL): الحد الأقصى للميزانية
- **created_at, updated_at** (TIMESTAMPTZ): تواريخ الإنشاء والتحديث

### 5. جدول الموظفين (employees)
- **id** (UUID): المفتاح الرئيسي
- **name** (TEXT): اسم الموظف
- **position** (TEXT): المنصب الوظيفي
- **salary** (DECIMAL): الراتب
- **contact** (TEXT): معلومات الاتصال
- **join_date** (DATE): تاريخ الانضمام
- **active** (BOOLEAN): هل الموظف نشط
- **project_id** (UUID): معرّف المشروع المرتبط به (اختياري)
- **national_id** (TEXT): رقم الهوية الوطنية
- **address** (TEXT): العنوان
- **emergency_contact** (TEXT): جهة اتصال للطوارئ
- **created_at, updated_at** (TIMESTAMPTZ): تواريخ الإنشاء والتحديث

### 6. جدول المعاملات المالية (transactions)
- **id** (UUID): المفتاح الرئيسي
- **date** (DATE): تاريخ المعاملة
- **type** (TEXT): نوع المعاملة (income, expense)
- **amount** (DECIMAL): المبلغ
- **description** (TEXT): وصف المعاملة
- **expense_type_id** (UUID): معرّف نوع المصروف
- **employee_id** (UUID): معرّف الموظف المرتبط (اختياري)
- **project_id** (UUID): معرّف المشروع المرتبط
- **reference** (TEXT): الرقم المرجعي للمعاملة
- **payment_method** (TEXT): طريقة الدفع (cash, bank, check)
- **status** (TEXT): حالة المعاملة (pending, approved, rejected)
- **created_by** (UUID): معرّف منشئ المعاملة
- **created_at, updated_at** (TIMESTAMPTZ): تواريخ الإنشاء والتحديث

### 7. جدول المستندات (documents)
- **id** (UUID): المفتاح الرئيسي
- **name** (TEXT): اسم المستند
- **description** (TEXT): وصف المستند
- **file_path** (TEXT): مسار الملف
- **file_size** (INTEGER): حجم الملف
- **file_type** (TEXT): نوع الملف
- **uploaded_by** (UUID): معرّف من قام بالرفع
- **category** (TEXT): تصنيف المستند
- **tags** (TEXT[]): وسوم المستند
- **created_at, updated_at** (TIMESTAMPTZ): تواريخ الإنشاء والتحديث

### 8. جدول روابط المستندات (document_links)
- **id** (UUID): المفتاح الرئيسي
- **document_id** (UUID): معرّف المستند
- **entity_type** (TEXT): نوع الكيان (project, transaction, employee)
- **entity_id** (UUID): معرّف الكيان
- **created_at** (TIMESTAMPTZ): تاريخ الإنشاء

### 9. جدول سجل الأنشطة (activity_logs)
- **id** (UUID): المفتاح الرئيسي
- **user_id** (UUID): معرّف المستخدم
- **action** (TEXT): الإجراء (create, update, delete, login)
- **entity_type** (TEXT): نوع الكيان المتأثر
- **entity_id** (UUID): معرّف الكيان المتأثر
- **details** (JSONB): تفاصيل النشاط بصيغة JSON
- **ip_address** (TEXT): عنوان IP
- **created_at** (TIMESTAMPTZ): تاريخ الإنشاء

### 10. جدول القيود المحاسبية (ledger_entries)
- **id** (UUID): المفتاح الرئيسي
- **transaction_id** (UUID): معرّف المعاملة المرتبطة
- **account** (TEXT): الحساب المتأثر
- **debit** (DECIMAL): المدين
- **credit** (DECIMAL): الدائن
- **balance** (DECIMAL): الرصيد
- **posting_date** (DATE): تاريخ الترحيل
- **description** (TEXT): وصف القيد
- **created_at, updated_at** (TIMESTAMPTZ): تواريخ الإنشاء والتحديث

### 11. جدول المستحقات (receivables)
- **id** (UUID): المفتاح الرئيسي
- **project_id** (UUID): معرّف المشروع المرتبط
- **amount** (DECIMAL): مبلغ المستحق
- **paid_amount** (DECIMAL): المبلغ المدفوع
- **due_date** (DATE): تاريخ الاستحقاق
- **status** (TEXT): حالة المستحق (pending, partial, paid, overdue)
- **description** (TEXT): وصف المستحق
- **client_name** (TEXT): اسم العميل
- **contact_info** (TEXT): معلومات الاتصال
- **created_at, updated_at** (TIMESTAMPTZ): تواريخ الإنشاء والتحديث

### 12. جدول مدفوعات المستحقات (receivable_payments)
- **id** (UUID): المفتاح الرئيسي
- **receivable_id** (UUID): معرّف المستحق المرتبط
- **amount** (DECIMAL): المبلغ المدفوع
- **payment_date** (DATE): تاريخ الدفع
- **payment_method** (TEXT): طريقة الدفع
- **reference_number** (TEXT): الرقم المرجعي للدفع
- **notes** (TEXT): ملاحظات
- **created_at** (TIMESTAMPTZ): تاريخ الإنشاء

### 13. جدول إعدادات النظام (settings)
- **id** (UUID): المفتاح الرئيسي
- **key** (TEXT): مفتاح الإعداد
- **value** (TEXT): قيمة الإعداد
- **description** (TEXT): وصف الإعداد
- **category** (TEXT): فئة الإعداد
- **created_at, updated_at** (TIMESTAMPTZ): تواريخ الإنشاء والتحديث

## 🛠️ وحدات البرنامج (Modules)

### 1. وحدة المستخدمين والصلاحيات
- **إدارة المستخدمين**: إنشاء، تعديل، حذف، تعليق المستخدمين
- **إدارة الأدوار**: تحديد وتخصيص الأدوار للمستخدمين
- **إدارة الصلاحيات**: تخصيص صلاحيات محددة للمستخدمين
- **تسجيل الدخول/الخروج**: مصادقة وتتبع جلسات المستخدمين
- **الملف الشخصي**: إدارة معلومات الملف الشخصي

### 2. وحدة إدارة المشاريع
- **إنشاء وإدارة المشاريع**: إضافة، تعديل، حذف المشاريع
- **تتبع حالة المشروع**: مراقبة تقدم المشروع وحالته
- **إدارة ميزانية المشروع**: تخصيص وتتبع الميزانية والمصروفات
- **تخصيص المستخدمين للمشاريع**: ربط المستخدمين بالمشاريع وتحديد أدوارهم
- **معلومات العملاء**: إدارة بيانات العملاء المرتبطين بالمشاريع

### 3. وحدة المعاملات المالية
- **تسجيل المصروفات**: إدخال وتتبع المصروفات
- **تسجيل الإيرادات**: إدخال وتتبع الإيرادات
- **معالجة المعاملات**: اعتماد، رفض، تعليق المعاملات
- **تصنيف المعاملات**: تنظيم المعاملات حسب الأنواع والفئات
- **تقارير المعاملات**: تقارير تفصيلية وملخصة للمعاملات

### 4. وحدة إدارة المستندات
- **رفع المستندات**: رفع وتخزين المستندات والملفات
- **تصنيف المستندات**: تنظيم المستندات حسب الفئات
- **ربط المستندات**: ربط المستندات بالمشاريع والمعاملات والموظفين
- **البحث في المستندات**: البحث والوصول السريع للمستندات
- **إدارة الوصول للمستندات**: تحديد صلاحيات الوصول للمستندات

### 5. وحدة إدارة الموظفين
- **إضافة وإدارة الموظفين**: تسجيل بيانات الموظفين
- **تخصيص الموظفين للمشاريع**: ربط الموظفين بالمشاريع
- **إدارة الرواتب**: تسجيل وتتبع رواتب الموظفين
- **سجل الحضور**: تتبع حضور وغياب الموظفين
- **تقييم الأداء**: تقييم أداء الموظفين

### 6. وحدة المستحقات والمدفوعات
- **إدارة المستحقات**: تسجيل وتتبع المستحقات
- **جدولة المدفوعات**: تنظيم مواعيد الدفع
- **تسجيل المدفوعات**: تسجيل دفعات المستحقات
- **إشعارات الاستحقاق**: تنبيهات للمستحقات القادمة والمتأخرة
- **تقارير المستحقات**: تحليل وضع المستحقات

### 7. وحدة القيود المحاسبية
- **إنشاء القيود**: إنشاء القيود المحاسبية تلقائياً أو يدوياً
- **دفتر الأستاذ**: عرض وإدارة دفتر الأستاذ
- **التسويات**: إجراء التسويات المحاسبية
- **إغلاق الفترات**: إغلاق الفترات المحاسبية
- **تقارير محاسبية**: تقارير ميزان المراجعة والقوائم المالية

### 8. وحدة التقارير والإحصائيات
- **لوحة المعلومات**: عرض المؤشرات الرئيسية للأداء
- **تقارير المشاريع**: تقارير تفصيلية عن المشاريع
- **تقارير مالية**: تقارير الإيرادات والمصروفات والأرباح
- **تحليلات البيانات**: تحليل اتجاهات البيانات ومقارنات
- **تصدير التقارير**: تصدير التقارير بصيغ متعددة

### 9. وحدة الإعدادات والنظام
- **إعدادات عامة**: تخصيص إعدادات النظام
- **النسخ الاحتياطي**: إنشاء واستعادة النسخ الاحتياطية
- **سجلات النظام**: تتبع أنشطة النظام والمستخدمين
- **تخصيص الواجهة**: تعديل مظهر وسلوك الواجهة
- **إدارة البيانات الأساسية**: إدارة البيانات الثابتة مثل العملات وأنواع المصروفات

## 📝 المتطلبات الوظيفية

### متطلبات أساسية
1. **واجهة عربية كاملة** مع دعم اللغة العربية RTL
2. **نظام صلاحيات متعدد المستويات** يدعم أدوار مختلفة (مدير، محاسب، مستخدم، مشاهد)
3. **قائمة جانبية مخصصة** تعرض الوحدات المتاحة حسب صلاحيات المستخدم
4. **لوحة معلومات** تعرض المؤشرات الرئيسية والإحصائيات الهامة
5. **نظام إشعارات** لتنبيه المستخدمين بالأحداث المهمة
6. **بحث متقدم** في جميع أجزاء النظام
7. **استيراد وتصدير البيانات** بصيغ متعددة (Excel, CSV, PDF)
8. **تاريخ للأنشطة** يتتبع جميع العمليات التي تتم في النظام

### متطلبات المشاريع
9. **إنشاء وإدارة المشاريع** مع معلومات تفصيلية
10. **تتبع ميزانية المشروع** بشكل تلقائي مع تحديث الرصيد المتبقي
11. **ربط المستخدمين بالمشاريع** مع تحديد أدوارهم
12. **عرض تقدم المشروع** بصرياً مع مؤشرات الأداء
13. **إدارة مراحل المشروع** وتتبع إنجاز كل مرحلة

### متطلبات المعاملات المالية
14. **تسجيل المعاملات المالية** (إيرادات ومصروفات) مع تفاصيل كاملة
15. **ربط المعاملات بالمشاريع والموظفين** لتتبع دقيق للمصروفات
16. **دعم طرق دفع متعددة** (نقداً، تحويل بنكي، شيك)
17. **عملية اعتماد متعددة المستويات** للمعاملات المالية
18. **تحديث تلقائي لميزانية المشروع** عند إضافة معاملات جديدة
19. **تصنيف المعاملات** حسب الأنواع والفئات
20. **إرفاق المستندات** مع المعاملات المالية (فواتير، إيصالات)

### متطلبات المستندات
21. **رفع وتخزين المستندات** بأنواع متعددة (PDF, DOCX, JPG)
22. **تصنيف المستندات** حسب الفئات والمشاريع
23. **ربط المستندات بالكيانات الأخرى** (مشاريع، معاملات، موظفين)
24. **البحث في محتوى المستندات** وبياناتها الوصفية
25. **تحديد صلاحيات الوصول** للمستندات حسب المستخدمين

### متطلبات الموظفين
26. **إدارة بيانات الموظفين** مع معلومات تفصيلية
27. **ربط الموظفين بالمشاريع** وتتبع ساعات العمل
28. **إدارة الرواتب والمستحقات** للموظفين
29. **سجل الحضور والانصراف** للموظفين
30. **تقييم أداء الموظفين** دورياً

### متطلبات المحاسبة
31. **إنشاء قيود محاسبية تلقائية** عند إدخال المعاملات
32. **دفتر أستاذ كامل** مع تتبع الحسابات
33. **ميزان مراجعة** تفصيلي وملخص
34. **إعداد القوائم المالية** (قائمة الدخل، المركز المالي، التدفقات النقدية)
35. **إقفال الفترات المحاسبية** وترحيل الأرصدة
36. **تقارير ضريبية** وإعدادها بشكل آلي

### متطلبات المستحقات والمدفوعات
37. **إدارة المستحقات** وتتبعها بشكل دقيق
38. **جدولة المدفوعات** وإرسال إشعارات تلقائية
39. **تحديث حالة المستحقات** تلقائياً عند استلام الدفعات
40. **عرض تاريخ المدفوعات** لكل مستحق
41. **تقارير تحليلية** للمستحقات والمدفوعات

### متطلبات التقارير
42. **تقارير تفصيلية وملخصة** لجميع جوانب النظام
43. **تقارير مخصصة** يمكن إنشاؤها حسب متطلبات المستخدم
44. **تصدير التقارير** بصيغ متعددة
45. **جدولة التقارير** لإرسالها تلقائياً
46. **تمثيل بصري للبيانات** (رسوم بيانية، مخططات)

## 💻 المتطلبات التقنية

1. **الواجهة الأمامية**:
   - React.js مع TypeScript
   - Tailwind CSS للتصميم
   - نظام مكونات متعدد الاستخدامات
   - دعم كامل للواجهات العربية (RTL)
   - تصميم متجاوب لجميع الأجهزة

2. **الخادم والواجهة الخلفية**:
   - Node.js مع Express
   - TypeScript للتطوير الآمن
   - API RESTful مع توثيق Swagger
   - معالجة أخطاء شاملة
   - نظام تسجيل متقدم (logging)

3. **قاعدة البيانات**:
   - Supabase (PostgreSQL)
   - Row-Level Security لأمان البيانات
   - فهارس وقيود لضمان سلامة البيانات
   - دوال وإجراءات محفوظة (Stored Procedures)
   - محفزات (Triggers) للتحديثات التلقائية

4. **الأمان**:
   - مصادقة JWT مع Supabase Auth
   - تشفير البيانات الحساسة
   - حماية من هجمات CSRF و XSS
   - تسجيل وتتبع الأنشطة المشبوهة
   - إدارة الجلسات مع تسجيل خروج تلقائي

5. **النشر والاستضافة**:
   - Netlify للواجهة الأمامية
   - Netlify Functions للخادم
   - Supabase للقاعدة البيانات وتخزين الملفات
   - تكامل CI/CD لنشر تلقائي
   - مراقبة الأداء والأخطاء

6. **التخزين والملفات**:
   - Supabase Storage لتخزين المستندات
   - معالجة الصور تلقائياً
   - تحويل الملفات عند الحاجة
   - نظام تصاريح للملفات

7. **الأداء**:
   - تخزين مؤقت (caching) للبيانات المتكررة
   - تحميل كسول (lazy loading) للمكونات والصفحات
   - تصغير وضغط الأصول (assets)
   - تحسين استعلامات قاعدة البيانات

8. **قابلية التوسع**:
   - هيكل وحدات قابلة للتوسع
   - نظام مكونات متعدد الاستخدام
   - فصل واضح بين طبقات التطبيق
   - توثيق شامل للكود والواجهات البرمجية

## 🚀 المتطلبات المستقبلية

1. **تطبيق الهاتف المحمول** للوصول السريع والإشعارات
2. **وحدة إدارة المخزون** للمواد والمعدات
3. **ذكاء اصطناعي** للتنبؤ بتكاليف المشاريع وتحليل البيانات
4. **تكامل مع أنظمة خارجية** (ضرائب، بنوك، موردين)
5. **دعم متعدد اللغات** مع بقاء العربية كلغة أساسية
6. **وحدة تخطيط موارد المشاريع** المتكاملة
7. **نظام عقود إلكتروني** مع توقيع إلكتروني
8. **لوحات معلومات متقدمة** مع تحليلات تفاعلية