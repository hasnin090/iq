#!/bin/bash
echo "๐ ุจุฏุก ุงุฎุชุจุงุฑ ุดุงูู ูุจู ุงูุฑูุน..."

# ุชุฃูุฏ ูู ุฃู ุงูุฃุฏูุงุช ูุงุจูุฉ ููุชูููุฐ
chmod +x check-netlify-config.sh
chmod +x check-redirects.sh

# ุงุฎุชุจุงุฑ ุชูููู Netlify
echo "------------------------------"
echo "๐ ุงุฎุชุจุงุฑ ุชูููู Netlify"
echo "------------------------------"
./check-netlify-config.sh
if [ $? -ne 0 ]; then
    echo "โ ูุดู ุงุฎุชุจุงุฑ ุชูููู Netlify!"
    exit 1
fi

# ุงุฎุชุจุงุฑ ุฏุงูุฉ API
echo "------------------------------"
echo "๐ ุงุฎุชุจุงุฑ ุฏุงูุฉ API"
echo "------------------------------"
node ./test-api.js
if [ $? -ne 0 ]; then
    echo "โ ูุดู ุงุฎุชุจุงุฑ ุฏุงูุฉ API!"
    exit 1
fi

# ุงุฎุชุจุงุฑ ููู _redirects
echo "------------------------------"
echo "๐ ุงุฎุชุจุงุฑ ููู _redirects"
echo "------------------------------"
./check-redirects.sh
if [ $? -ne 0 ]; then
    echo "โ ูุดู ุงุฎุชุจุงุฑ ููู _redirects!"
    exit 1
fi

# ุงุฎุชุจุงุฑ ุจูุงุก ุชุฌุฑูุจู ุณุฑูุน
echo "------------------------------"
echo "๐ ุงุฎุชุจุงุฑ ุตุญุฉ ููู netlify.toml"
echo "------------------------------"

# ุฅูุดุงุก ูุณุฎุฉ ูุคูุชุฉ ูู ููู netlify.toml
cp netlify.toml netlify.toml.bak

# ุนุฑุถ ูุญุชูู ููู netlify.toml
echo "๐ ูุญุชูู ููู netlify.toml:"
cat netlify.toml | grep -v "^#" | grep -v "^$"

echo ""
echo "โ๏ธ ุชุญุฐูุฑ: ุชุฃูุฏ ูู ุฃู ูุญุชูู ุงูููู ุตุญูุญ ููุง ูุญุชูู ุนูู ุฃุฎุทุงุก ุชูุณูู."
echo "ูู ูุญุชูู ุงูููู ุตุญูุญุ (y/n)"
read -r answer

if [ "$answer" != "y" ]; then
    echo "๐ ุงูุฑุฌุงุก ุชุตุญูุญ ุงูููู ูุจู ุงููุชุงุจุนุฉ."
    exit 1
fi

echo "๐ ุงูุงุฎุชุจุงุฑ ุงูุดุงูู ุงูุชูู ุจูุฌุงุญ! ุงููุดุฑูุน ุฌุงูุฒ ููุฑูุน."
